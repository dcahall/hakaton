begin;
drop table if exists incident_sum;

create table incident_sum as
select
	unom,
	count(1) as cnt,
	cast(date_ext_created as date) as date_ext_created
from
	incident
group by
	unom,
	cast(date_ext_created as date);

drop table if exists incident_pivot;

create table incident_pivot as
select
	unom,
	cast(date_ext_created as date) as date_ext_created,
	sum(case when name = 'asupr' then 1 else 0 end) as asupr,
	sum(case when name = 'gormost' then 1 else 0 end) as gormost,
	sum(case when name = 'edc' then 1 else 0 end) as edc,
	sum(case when name = 'mgi' then 1 else 0 end) as mgi,
	sum(case when name = 'cafap' then 1 else 0 end) as cafap,
	sum(case when name = 'mos_gas' then 1 else 0 end) as mos_gas,
	sum(case when name = 'mvk' then 1 else 0 end) as mvk,
	sum(case when name = 'ng' then 1 else 0 end) as ng,
	sum(case when event_id = 1 then 1 else 0 end) as event_1,
	sum(case when event_id = 2 then 1 else 0 end) as event_2,
	sum(case when event_id = 3 then 1 else 0 end) as event_3,
	sum(case when event_id = 4 then 1 else 0 end) as event_4,
	sum(case when event_id = 5 then 1 else 0 end) as event_5,
	sum(case when event_id = 6 then 1 else 0 end) as event_6,
	sum(case when event_id = 7 then 1 else 0 end) as event_7,
	sum(case when event_id = 8 then 1 else 0 end) as event_8,
	sum(case when event_id = 9 then 1 else 0 end) as event_9,
	sum(case when event_id = 10 then 1 else 0 end) as event_10,
	sum(case when event_id = 11 then 1 else 0 end) as event_11,
	sum(case when event_id = 12 then 1 else 0 end) as event_12,
	sum(case when event_id = 13 then 1 else 0 end) as event_13,
	sum(case when event_id = 14 then 1 else 0 end) as event_14,
	sum(case when event_id = 15 then 1 else 0 end) as event_15,
	sum(case when event_id = 16 then 1 else 0 end) as event_16,
	sum(case when event_id = 17 then 1 else 0 end) as event_17,
	sum(case when event_id = 18 then 1 else 0 end) as event_18,
	sum(case when event_id = 19 then 1 else 0 end) as event_19,
	sum(case when event_id = 20 then 1 else 0 end) as event_20,
	sum(case when event_id = 21 then 1 else 0 end) as event_21,
	sum(case when event_id = 22 then 1 else 0 end) as event_22,
	sum(case when event_id = 23 then 1 else 0 end) as event_23,
	sum(case when event_id = 24 then 1 else 0 end) as event_24,
	sum(case when event_id = 25 then 1 else 0 end) as event_25,
	sum(case when event_id = 26 then 1 else 0 end) as event_26,
	sum(case when event_id = 27 then 1 else 0 end) as event_27,
	sum(case when event_id = 28 then 1 else 0 end) as event_28,
	sum(case when event_id = 29 then 1 else 0 end) as event_29,
	sum(case when event_id = 30 then 1 else 0 end) as event_30,
	sum(case when event_id = 31 then 1 else 0 end) as event_31,
	sum(case when event_id = 32 then 1 else 0 end) as event_32,
	sum(case when event_id = 33 then 1 else 0 end) as event_33,
	sum(case when event_id = 34 then 1 else 0 end) as event_34,
	sum(case when event_id = 35 then 1 else 0 end) as event_35,
	sum(case when event_id = 36 then 1 else 0 end) as event_36,
	sum(case when event_id = 37 then 1 else 0 end) as event_37,
	sum(case when event_id = 38 then 1 else 0 end) as event_38,
	sum(case when event_id = 39 then 1 else 0 end) as event_39,
	sum(case when event_id = 40 then 1 else 0 end) as event_40,
	sum(case when event_id = 41 then 1 else 0 end) as event_41,
	sum(case when event_id = 42 then 1 else 0 end) as event_42,
	sum(case when event_id = 43 then 1 else 0 end) as event_43,
	sum(case when event_id = 44 then 1 else 0 end) as event_44,
	sum(case when event_id = 45 then 1 else 0 end) as event_45,
	sum(case when event_id = 46 then 1 else 0 end) as event_46,
	sum(case when event_id = 47 then 1 else 0 end) as event_47,
	sum(case when event_id = 48 then 1 else 0 end) as event_48,
	sum(case when event_id = 49 then 1 else 0 end) as event_49,
	sum(case when event_id = 50 then 1 else 0 end) as event_50,
	sum(case when event_id = 51 then 1 else 0 end) as event_51,
	sum(case when event_id = 52 then 1 else 0 end) as event_52,
	sum(case when event_id = 53 then 1 else 0 end) as event_53,
	sum(case when event_id = 54 then 1 else 0 end) as event_54,
	sum(case when event_id = 55 then 1 else 0 end) as event_55,
	sum(case when event_id = 56 then 1 else 0 end) as event_56,
	sum(case when event_id = 57 then 1 else 0 end) as event_57,
	sum(case when event_id = 58 then 1 else 0 end) as event_58,
	sum(case when event_id = 59 then 1 else 0 end) as event_59,
	sum(case when event_id = 60 then 1 else 0 end) as event_60,
	sum(case when event_id = 61 then 1 else 0 end) as event_61,
	sum(case when event_id = 62 then 1 else 0 end) as event_62,
	sum(case when event_id = 63 then 1 else 0 end) as event_63,
	sum(case when event_id = 64 then 1 else 0 end) as event_64,
	sum(case when event_id = 65 then 1 else 0 end) as event_65,
	sum(case when event_id = 66 then 1 else 0 end) as event_66,
	sum(case when event_id = 67 then 1 else 0 end) as event_67,
	sum(case when event_id = 68 then 1 else 0 end) as event_68,
	sum(case when event_id = 69 then 1 else 0 end) as event_69,
	sum(case when event_id = 70 then 1 else 0 end) as event_70,
	sum(case when event_id = 71 then 1 else 0 end) as event_71,
	sum(case when event_id = 72 then 1 else 0 end) as event_72,
	sum(case when event_id = 73 then 1 else 0 end) as event_73,
	sum(case when event_id = 74 then 1 else 0 end) as event_74,
	sum(case when event_id = 75 then 1 else 0 end) as event_75,
	sum(case when event_id = 76 then 1 else 0 end) as event_76,
	sum(case when event_id = 77 then 1 else 0 end) as event_77,
	sum(case when event_id = 78 then 1 else 0 end) as event_78,
	sum(case when event_id = 79 then 1 else 0 end) as event_79,
	sum(case when event_id = 80 then 1 else 0 end) as event_80,
	sum(case when event_id = 81 then 1 else 0 end) as event_81,
	sum(case when event_id = 82 then 1 else 0 end) as event_82,
	sum(case when event_id = 83 then 1 else 0 end) as event_83,
	sum(case when event_id = 84 then 1 else 0 end) as event_84,
	sum(case when event_id = 85 then 1 else 0 end) as event_85,
	sum(case when event_id = 86 then 1 else 0 end) as event_86,
	sum(case when event_id = 87 then 1 else 0 end) as event_87,
	sum(case when event_id = 88 then 1 else 0 end) as event_88,
	sum(case when event_id = 89 then 1 else 0 end) as event_89,
	sum(case when event_id = 90 then 1 else 0 end) as event_90,
	sum(case when event_id = 91 then 1 else 0 end) as event_91,
	sum(case when event_id = 92 then 1 else 0 end) as event_92,
	sum(case when event_id = 93 then 1 else 0 end) as event_93,
	sum(case when event_id = 94 then 1 else 0 end) as event_94,
	sum(case when event_id = 95 then 1 else 0 end) as event_95,
	sum(case when event_id = 96 then 1 else 0 end) as event_96,
	sum(case when event_id = 97 then 1 else 0 end) as event_97,
	sum(case when event_id = 98 then 1 else 0 end) as event_98,
	sum(case when event_id = 99 then 1 else 0 end) as event_99,
	sum(case when event_id = 100 then 1 else 0 end) as event_100,
	sum(case when event_id = 101 then 1 else 0 end) as event_101,
	sum(case when event_id = 102 then 1 else 0 end) as event_102,
	sum(case when event_id = 103 then 1 else 0 end) as event_103,
	sum(case when event_id = 104 then 1 else 0 end) as event_104,
	sum(case when event_id = 105 then 1 else 0 end) as event_105,
	sum(case when event_id = 106 then 1 else 0 end) as event_106,
	sum(case when event_id = 107 then 1 else 0 end) as event_107,
	sum(case when event_id = 108 then 1 else 0 end) as event_108,
	sum(case when event_id = 109 then 1 else 0 end) as event_109,
	sum(case when event_id = 110 then 1 else 0 end) as event_110,
	sum(case when event_id = 111 then 1 else 0 end) as event_111,
	sum(case when event_id = 112 then 1 else 0 end) as event_112,
	sum(case when event_id = 113 then 1 else 0 end) as event_113,
	sum(case when event_id = 114 then 1 else 0 end) as event_114,
	sum(case when event_id = 115 then 1 else 0 end) as event_115,
	sum(case when event_id = 116 then 1 else 0 end) as event_116,
	sum(case when event_id = 117 then 1 else 0 end) as event_117,
	sum(case when event_id = 118 then 1 else 0 end) as event_118,
	sum(case when event_id = 119 then 1 else 0 end) as event_119,
	sum(case when event_id = 120 then 1 else 0 end) as event_120,
	sum(case when event_id = 121 then 1 else 0 end) as event_121,
	sum(case when event_id = 122 then 1 else 0 end) as event_122,
	sum(case when event_id = 123 then 1 else 0 end) as event_123,
	sum(case when event_id = 124 then 1 else 0 end) as event_124,
	sum(case when event_id = 125 then 1 else 0 end) as event_125,
	sum(case when event_id = 126 then 1 else 0 end) as event_126,
	sum(case when event_id = 127 then 1 else 0 end) as event_127,
	sum(case when event_id = 128 then 1 else 0 end) as event_128,
	sum(case when event_id = 129 then 1 else 0 end) as event_129,
	sum(case when event_id = 130 then 1 else 0 end) as event_130,
	sum(case when event_id = 131 then 1 else 0 end) as event_131,
	sum(case when event_id = 132 then 1 else 0 end) as event_132,
	sum(case when event_id = 133 then 1 else 0 end) as event_133,
	sum(case when event_id = 134 then 1 else 0 end) as event_134,
	sum(case when event_id = 135 then 1 else 0 end) as event_135,
	sum(case when event_id = 136 then 1 else 0 end) as event_136,
	sum(case when event_id = 137 then 1 else 0 end) as event_137,
	sum(case when event_id = 138 then 1 else 0 end) as event_138,
	sum(case when event_id = 139 then 1 else 0 end) as event_139,
	sum(case when event_id = 140 then 1 else 0 end) as event_140,
	sum(case when event_id = 141 then 1 else 0 end) as event_141,
	sum(case when event_id = 142 then 1 else 0 end) as event_142,
	sum(case when event_id = 143 then 1 else 0 end) as event_143,
	sum(case when event_id = 144 then 1 else 0 end) as event_144,
	sum(case when event_id = 145 then 1 else 0 end) as event_145,
	sum(case when event_id = 146 then 1 else 0 end) as event_146,
	sum(case when event_id = 147 then 1 else 0 end) as event_147,
	sum(case when event_id = 148 then 1 else 0 end) as event_148,
	sum(case when event_id = 149 then 1 else 0 end) as event_149,
	sum(case when event_id = 150 then 1 else 0 end) as event_150,
	sum(case when event_id = 151 then 1 else 0 end) as event_151,
	sum(case when event_id = 152 then 1 else 0 end) as event_152,
	sum(case when event_id = 153 then 1 else 0 end) as event_153,
	sum(case when event_id = 154 then 1 else 0 end) as event_154,
	sum(case when event_id = 155 then 1 else 0 end) as event_155,
	sum(case when event_id = 156 then 1 else 0 end) as event_156,
	sum(case when event_id = 157 then 1 else 0 end) as event_157,
	sum(case when event_id = 158 then 1 else 0 end) as event_158,
	sum(case when event_id = 159 then 1 else 0 end) as event_159,
	sum(case when event_id = 160 then 1 else 0 end) as event_160,
	sum(case when event_id = 161 then 1 else 0 end) as event_161,
	sum(case when event_id = 162 then 1 else 0 end) as event_162,
	sum(case when event_id = 163 then 1 else 0 end) as event_163,
	sum(case when event_id = 164 then 1 else 0 end) as event_164,
	sum(case when event_id = 165 then 1 else 0 end) as event_165,
	sum(case when event_id = 166 then 1 else 0 end) as event_166,
	sum(case when event_id = 167 then 1 else 0 end) as event_167,
	sum(case when event_id = 168 then 1 else 0 end) as event_168,
	sum(case when event_id = 169 then 1 else 0 end) as event_169,
	sum(case when event_id = 170 then 1 else 0 end) as event_170,
	sum(case when event_id = 171 then 1 else 0 end) as event_171,
	sum(case when event_id = 172 then 1 else 0 end) as event_172,
	sum(case when event_id = 173 then 1 else 0 end) as event_173,
	sum(case when event_id = 174 then 1 else 0 end) as event_174,
	sum(case when event_id = 175 then 1 else 0 end) as event_175,
	sum(case when event_id = 176 then 1 else 0 end) as event_176,
	sum(case when event_id = 177 then 1 else 0 end) as event_177,
	sum(case when event_id = 178 then 1 else 0 end) as event_178,
	sum(case when event_id = 179 then 1 else 0 end) as event_179,
	sum(case when event_id = 180 then 1 else 0 end) as event_180,
	sum(case when event_id = 181 then 1 else 0 end) as event_181,
	sum(case when event_id = 182 then 1 else 0 end) as event_182,
	sum(case when event_id = 183 then 1 else 0 end) as event_183,
	sum(case when event_id = 184 then 1 else 0 end) as event_184,
	sum(case when event_id = 185 then 1 else 0 end) as event_185,
	sum(case when event_id = 186 then 1 else 0 end) as event_186,
	sum(case when event_id = 187 then 1 else 0 end) as event_187,
	sum(case when event_id = 188 then 1 else 0 end) as event_188,
	sum(case when event_id = 189 then 1 else 0 end) as event_189,
	sum(case when event_id = 190 then 1 else 0 end) as event_190,
	sum(case when event_id = 191 then 1 else 0 end) as event_191,
	sum(case when event_id = 192 then 1 else 0 end) as event_192,
	sum(case when event_id = 193 then 1 else 0 end) as event_193,
	sum(case when event_id = 194 then 1 else 0 end) as event_194,
	sum(case when event_id = 195 then 1 else 0 end) as event_195,
	sum(case when event_id = 196 then 1 else 0 end) as event_196,
	sum(case when event_id = 197 then 1 else 0 end) as event_197,
	sum(case when event_id = 198 then 1 else 0 end) as event_198,
	sum(case when event_id = 199 then 1 else 0 end) as event_199,
	sum(case when event_id = 200 then 1 else 0 end) as event_200,
	sum(case when event_id = 201 then 1 else 0 end) as event_201,
	sum(case when event_id = 202 then 1 else 0 end) as event_202,
	sum(case when event_id = 203 then 1 else 0 end) as event_203,
	sum(case when event_id = 204 then 1 else 0 end) as event_204,
	sum(case when event_id = 205 then 1 else 0 end) as event_205,
	sum(case when event_id = 206 then 1 else 0 end) as event_206,
	sum(case when event_id = 207 then 1 else 0 end) as event_207,
	sum(case when event_id = 208 then 1 else 0 end) as event_208,
	sum(case when event_id = 209 then 1 else 0 end) as event_209,
	sum(case when event_id = 210 then 1 else 0 end) as event_210,
	sum(case when event_id = 211 then 1 else 0 end) as event_211,
	sum(case when event_id = 212 then 1 else 0 end) as event_212,
	sum(case when event_id = 213 then 1 else 0 end) as event_213,
	sum(case when event_id = 214 then 1 else 0 end) as event_214,
	sum(case when event_id = 215 then 1 else 0 end) as event_215,
	sum(case when event_id = 216 then 1 else 0 end) as event_216,
	sum(case when event_id = 217 then 1 else 0 end) as event_217,
	sum(case when event_id = 218 then 1 else 0 end) as event_218,
	sum(case when event_id = 219 then 1 else 0 end) as event_219,
	sum(case when event_id = 220 then 1 else 0 end) as event_220,
	sum(case when event_id = 221 then 1 else 0 end) as event_221,
	sum(case when event_id = 222 then 1 else 0 end) as event_222,
	sum(case when event_id = 223 then 1 else 0 end) as event_223,
	sum(case when event_id = 224 then 1 else 0 end) as event_224,
	sum(case when event_id = 225 then 1 else 0 end) as event_225,
	sum(case when event_id = 226 then 1 else 0 end) as event_226,
	sum(case when event_id = 227 then 1 else 0 end) as event_227,
	sum(case when event_id = 228 then 1 else 0 end) as event_228,
	sum(case when event_id = 229 then 1 else 0 end) as event_229,
	sum(case when event_id = 230 then 1 else 0 end) as event_230,
	sum(case when event_id = 231 then 1 else 0 end) as event_231,
	sum(case when event_id = 232 then 1 else 0 end) as event_232,
	sum(case when event_id = 233 then 1 else 0 end) as event_233,
	sum(case when event_id = 234 then 1 else 0 end) as event_234,
	sum(case when event_id = 235 then 1 else 0 end) as event_235,
	sum(case when event_id = 236 then 1 else 0 end) as event_236,
	sum(case when event_id = 237 then 1 else 0 end) as event_237,
	sum(case when event_id = 238 then 1 else 0 end) as event_238,
	sum(case when event_id = 239 then 1 else 0 end) as event_239,
	sum(case when event_id = 240 then 1 else 0 end) as event_240,
	sum(case when event_id = 241 then 1 else 0 end) as event_241,
	sum(case when event_id = 242 then 1 else 0 end) as event_242,
	sum(case when event_id = 243 then 1 else 0 end) as event_243,
	sum(case when event_id = 244 then 1 else 0 end) as event_244,
	sum(case when event_id = 245 then 1 else 0 end) as event_245,
	sum(case when event_id = 246 then 1 else 0 end) as event_246,
	sum(case when event_id = 247 then 1 else 0 end) as event_247,
	sum(case when event_id = 248 then 1 else 0 end) as event_248,
	sum(case when event_id = 249 then 1 else 0 end) as event_249,
	sum(case when event_id = 250 then 1 else 0 end) as event_250,
	sum(case when event_id = 251 then 1 else 0 end) as event_251,
	sum(case when event_id = 252 then 1 else 0 end) as event_252,
	sum(case when event_id = 253 then 1 else 0 end) as event_253,
	sum(case when event_id = 254 then 1 else 0 end) as event_254,
	sum(case when event_id = 255 then 1 else 0 end) as event_255,
	sum(case when event_id = 256 then 1 else 0 end) as event_256,
	sum(case when event_id = 257 then 1 else 0 end) as event_257,
	sum(case when event_id = 258 then 1 else 0 end) as event_258,
	sum(case when event_id = 259 then 1 else 0 end) as event_259,
	sum(case when event_id = 260 then 1 else 0 end) as event_260,
	sum(case when event_id = 261 then 1 else 0 end) as event_261,
	sum(case when event_id = 262 then 1 else 0 end) as event_262,
	sum(case when event_id = 263 then 1 else 0 end) as event_263,
	sum(case when event_id = 264 then 1 else 0 end) as event_264,
	sum(case when event_id = 265 then 1 else 0 end) as event_265,
	sum(case when event_id = 266 then 1 else 0 end) as event_266,
	sum(case when event_id = 267 then 1 else 0 end) as event_267,
	sum(case when event_id = 268 then 1 else 0 end) as event_268,
	sum(case when event_id = 269 then 1 else 0 end) as event_269,
	sum(case when event_id = 270 then 1 else 0 end) as event_270,
	sum(case when event_id = 271 then 1 else 0 end) as event_271,
	sum(case when event_id = 272 then 1 else 0 end) as event_272,
	sum(case when event_id = 273 then 1 else 0 end) as event_273,
	sum(case when event_id = 274 then 1 else 0 end) as event_274,
	sum(case when event_id = 275 then 1 else 0 end) as event_275,
	sum(case when event_id = 276 then 1 else 0 end) as event_276,
	sum(case when event_id = 277 then 1 else 0 end) as event_277,
	sum(case when event_id = 278 then 1 else 0 end) as event_278,
	sum(case when event_id = 279 then 1 else 0 end) as event_279,
	sum(case when event_id = 280 then 1 else 0 end) as event_280,
	sum(case when event_id = 281 then 1 else 0 end) as event_281,
	sum(case when event_id = 282 then 1 else 0 end) as event_282,
	sum(case when event_id = 283 then 1 else 0 end) as event_283,
	sum(case when event_id = 284 then 1 else 0 end) as event_284,
	sum(case when event_id = 285 then 1 else 0 end) as event_285,
	sum(case when event_id = 286 then 1 else 0 end) as event_286,
	sum(case when event_id = 287 then 1 else 0 end) as event_287,
	sum(case when event_id = 288 then 1 else 0 end) as event_288,
	sum(case when event_id = 289 then 1 else 0 end) as event_289,
	sum(case when event_id = 290 then 1 else 0 end) as event_290,
	sum(case when event_id = 291 then 1 else 0 end) as event_291,
	sum(case when event_id = 292 then 1 else 0 end) as event_292,
	sum(case when event_id = 293 then 1 else 0 end) as event_293,
	sum(case when event_id = 294 then 1 else 0 end) as event_294,
	sum(case when event_id = 295 then 1 else 0 end) as event_295,
	sum(case when event_id = 296 then 1 else 0 end) as event_296,
	sum(case when event_id = 297 then 1 else 0 end) as event_297,
	sum(case when event_id = 298 then 1 else 0 end) as event_298,
	sum(case when event_id = 299 then 1 else 0 end) as event_299,
	sum(case when event_id = 300 then 1 else 0 end) as event_300,
	sum(case when event_id = 301 then 1 else 0 end) as event_301
from
	incident as i
join system as s on
	i.system_id = s.id
group by
	unom,
	cast(date_ext_created as date);

drop table if exists incident_pivot_sum;

create table incident_pivot_sum as
select
	i_p.unom,
	i_p.date_ext_created,
	i_s.cnt,
	i_p.asupr,
	i_p.gormost,
	i_p.edc,
	i_p.mgi,
	i_p.cafap,
	i_p.mos_gas,
	i_p.mvk,
	i_p.ng,
	i_p.event_1,
	i_p.event_2,
	i_p.event_3,
	i_p.event_4,
	i_p.event_5,
	i_p.event_6,
	i_p.event_7,
	i_p.event_8,
	i_p.event_9,
	i_p.event_10,
	i_p.event_11,
	i_p.event_12,
	i_p.event_13,
	i_p.event_14,
	i_p.event_15,
	i_p.event_16,
	i_p.event_17,
	i_p.event_18,
	i_p.event_19,
	i_p.event_20,
	i_p.event_21,
	i_p.event_22,
	i_p.event_23,
	i_p.event_24,
	i_p.event_25,
	i_p.event_26,
	i_p.event_27,
	i_p.event_28,
	i_p.event_29,
	i_p.event_30,
	i_p.event_31,
	i_p.event_32,
	i_p.event_33,
	i_p.event_34,
	i_p.event_35,
	i_p.event_36,
	i_p.event_37,
	i_p.event_38,
	i_p.event_39,
	i_p.event_40,
	i_p.event_41,
	i_p.event_42,
	i_p.event_43,
	i_p.event_44,
	i_p.event_45,
	i_p.event_46,
	i_p.event_47,
	i_p.event_48,
	i_p.event_49,
	i_p.event_50,
	i_p.event_51,
	i_p.event_52,
	i_p.event_53,
	i_p.event_54,
	i_p.event_55,
	i_p.event_56,
	i_p.event_57,
	i_p.event_58,
	i_p.event_59,
	i_p.event_60,
	i_p.event_61,
	i_p.event_62,
	i_p.event_63,
	i_p.event_64,
	i_p.event_65,
	i_p.event_66,
	i_p.event_67,
	i_p.event_68,
	i_p.event_69,
	i_p.event_70,
	i_p.event_71,
	i_p.event_72,
	i_p.event_73,
	i_p.event_74,
	i_p.event_75,
	i_p.event_76,
	i_p.event_77,
	i_p.event_78,
	i_p.event_79,
	i_p.event_80,
	i_p.event_81,
	i_p.event_82,
	i_p.event_83,
	i_p.event_84,
	i_p.event_85,
	i_p.event_86,
	i_p.event_87,
	i_p.event_88,
	i_p.event_89,
	i_p.event_90,
	i_p.event_91,
	i_p.event_92,
	i_p.event_93,
	i_p.event_94,
	i_p.event_95,
	i_p.event_96,
	i_p.event_97,
	i_p.event_98,
	i_p.event_99,
	i_p.event_100,
	i_p.event_101,
	i_p.event_102,
	i_p.event_103,
	i_p.event_104,
	i_p.event_105,
	i_p.event_106,
	i_p.event_107,
	i_p.event_108,
	i_p.event_109,
	i_p.event_110,
	i_p.event_111,
	i_p.event_112,
	i_p.event_113,
	i_p.event_114,
	i_p.event_115,
	i_p.event_116,
	i_p.event_117,
	i_p.event_118,
	i_p.event_119,
	i_p.event_120,
	i_p.event_121,
	i_p.event_122,
	i_p.event_123,
	i_p.event_124,
	i_p.event_125,
	i_p.event_126,
	i_p.event_127,
	i_p.event_128,
	i_p.event_129,
	i_p.event_130,
	i_p.event_131,
	i_p.event_132,
	i_p.event_133,
	i_p.event_134,
	i_p.event_135,
	i_p.event_136,
	i_p.event_137,
	i_p.event_138,
	i_p.event_139,
	i_p.event_140,
	i_p.event_141,
	i_p.event_142,
	i_p.event_143,
	i_p.event_144,
	i_p.event_145,
	i_p.event_146,
	i_p.event_147,
	i_p.event_148,
	i_p.event_149,
	i_p.event_150,
	i_p.event_151,
	i_p.event_152,
	i_p.event_153,
	i_p.event_154,
	i_p.event_155,
	i_p.event_156,
	i_p.event_157,
	i_p.event_158,
	i_p.event_159,
	i_p.event_160,
	i_p.event_161,
	i_p.event_162,
	i_p.event_163,
	i_p.event_164,
	i_p.event_165,
	i_p.event_166,
	i_p.event_167,
	i_p.event_168,
	i_p.event_169,
	i_p.event_170,
	i_p.event_171,
	i_p.event_172,
	i_p.event_173,
	i_p.event_174,
	i_p.event_175,
	i_p.event_176,
	i_p.event_177,
	i_p.event_178,
	i_p.event_179,
	i_p.event_180,
	i_p.event_181,
	i_p.event_182,
	i_p.event_183,
	i_p.event_184,
	i_p.event_185,
	i_p.event_186,
	i_p.event_187,
	i_p.event_188,
	i_p.event_189,
	i_p.event_190,
	i_p.event_191,
	i_p.event_192,
	i_p.event_193,
	i_p.event_194,
	i_p.event_195,
	i_p.event_196,
	i_p.event_197,
	i_p.event_198,
	i_p.event_199,
	i_p.event_200,
	i_p.event_201,
	i_p.event_202,
	i_p.event_203,
	i_p.event_204,
	i_p.event_205,
	i_p.event_206,
	i_p.event_207,
	i_p.event_208,
	i_p.event_209,
	i_p.event_210,
	i_p.event_211,
	i_p.event_212,
	i_p.event_213,
	i_p.event_214,
	i_p.event_215,
	i_p.event_216,
	i_p.event_217,
	i_p.event_218,
	i_p.event_219,
	i_p.event_220,
	i_p.event_221,
	i_p.event_222,
	i_p.event_223,
	i_p.event_224,
	i_p.event_225,
	i_p.event_226,
	i_p.event_227,
	i_p.event_228,
	i_p.event_229,
	i_p.event_230,
	i_p.event_231,
	i_p.event_232,
	i_p.event_233,
	i_p.event_234,
	i_p.event_235,
	i_p.event_236,
	i_p.event_237,
	i_p.event_238,
	i_p.event_239,
	i_p.event_240,
	i_p.event_241,
	i_p.event_242,
	i_p.event_243,
	i_p.event_244,
	i_p.event_245,
	i_p.event_246,
	i_p.event_247,
	i_p.event_248,
	i_p.event_249,
	i_p.event_250,
	i_p.event_251,
	i_p.event_252,
	i_p.event_253,
	i_p.event_254,
	i_p.event_255,
	i_p.event_256,
	i_p.event_257,
	i_p.event_258,
	i_p.event_259,
	i_p.event_260,
	i_p.event_261,
	i_p.event_262,
	i_p.event_263,
	i_p.event_264,
	i_p.event_265,
	i_p.event_266,
	i_p.event_267,
	i_p.event_268,
	i_p.event_269,
	i_p.event_270,
	i_p.event_271,
	i_p.event_272,
	i_p.event_273,
	i_p.event_274,
	i_p.event_275,
	i_p.event_276,
	i_p.event_277,
	i_p.event_278,
	i_p.event_279,
	i_p.event_280,
	i_p.event_281,
	i_p.event_282,
	i_p.event_283,
	i_p.event_284,
	i_p.event_285,
	i_p.event_286,
	i_p.event_287,
	i_p.event_288,
	i_p.event_289,
	i_p.event_290,
	i_p.event_291,
	i_p.event_292,
	i_p.event_293,
	i_p.event_294,
	i_p.event_295,
	i_p.event_296,
	i_p.event_297,
	i_p.event_298,
	i_p.event_299,
	i_p.event_300,
	i_p.event_301
from
	incident_pivot as i_p
join incident_sum as i_s on
	i_p.unom = i_s.unom
	and i_p.date_ext_created = i_s.date_ext_created ;

drop table if exists prep_work;

create table prep_work as
select
	id,
	period,
	work_type_id,
	num_entrance,
	elevatornumber,
	plan_date_start,
	plan_date_end,
	fact_date_start,
	fact_date_end,
	unom,
	case
					when lag(fact_date_end) over (partition by unom,
																																				work_type_id
	order by
		fact_date_start) is null then cast('1900-01-01 00:00:00' as timestamp)
		else lag(fact_date_end) over (partition by unom,
																																				work_type_id
	order by
		fact_date_start) + interval '1 day'
	end as prev_date_end
from
	public.work;

drop table if exists object_with_work;

create table object_with_work as
select
	distinct w.work_type_id,
	w.prev_date_end,
	w.fact_date_start,
	o.unom,
	o.col_754,
	o.col_755,
	o.col_756,
	o.col_757,
	o.col_758_id,
	o.col_759,
	o.col_760,
	o.col_761,
	o.col_762,
	o.col_763,
	o.col_764,
	o.col_765,
	o.col_766,
	o.col_767,
	o.col_769_id,
	o.col_770_id,
	o.col_771,
	o.col_772,
	o.col_775_id,
	o.col_781_id,
	o.col_2156_id,
	o.col_2463_id,
	o.col_3163_id,
	o.col_3243_id,
	o.col_3363,
	o.col_103506_id
from
	object as o
left join prep_work as w on
	o.unom = w.unom
where
	o.col_2463_id = 42875644
	and o.col_3163_id = 58761330;

drop table if exists object_with_work_dates;

create table object_with_work_dates as
select
	work_type_id,
	prev_date_end,
	fact_date_start,
	unom
from
	object_with_work;

drop table if exists incident_pivot_sum_final;

create table incident_pivot_sum_final as
select
	distinct o_d.work_type_id,
	o_d.unom,
	o_d.fact_date_start,
	i_p.cnt,
	i_p.asupr,
	i_p.gormost,
	i_p.edc,
	i_p.mgi,
	i_p.cafap,
	i_p.mos_gas,
	i_p.mvk,
	i_p.ng,
	i_p.event_1,
	i_p.event_2,
	i_p.event_3,
	i_p.event_4,
	i_p.event_5,
	i_p.event_6,
	i_p.event_7,
	i_p.event_8,
	i_p.event_9,
	i_p.event_10,
	i_p.event_11,
	i_p.event_12,
	i_p.event_13,
	i_p.event_14,
	i_p.event_15,
	i_p.event_16,
	i_p.event_17,
	i_p.event_18,
	i_p.event_19,
	i_p.event_20,
	i_p.event_21,
	i_p.event_22,
	i_p.event_23,
	i_p.event_24,
	i_p.event_25,
	i_p.event_26,
	i_p.event_27,
	i_p.event_28,
	i_p.event_29,
	i_p.event_30,
	i_p.event_31,
	i_p.event_32,
	i_p.event_33,
	i_p.event_34,
	i_p.event_35,
	i_p.event_36,
	i_p.event_37,
	i_p.event_38,
	i_p.event_39,
	i_p.event_40,
	i_p.event_41,
	i_p.event_42,
	i_p.event_43,
	i_p.event_44,
	i_p.event_45,
	i_p.event_46,
	i_p.event_47,
	i_p.event_48,
	i_p.event_49,
	i_p.event_50,
	i_p.event_51,
	i_p.event_52,
	i_p.event_53,
	i_p.event_54,
	i_p.event_55,
	i_p.event_56,
	i_p.event_57,
	i_p.event_58,
	i_p.event_59,
	i_p.event_60,
	i_p.event_61,
	i_p.event_62,
	i_p.event_63,
	i_p.event_64,
	i_p.event_65,
	i_p.event_66,
	i_p.event_67,
	i_p.event_68,
	i_p.event_69,
	i_p.event_70,
	i_p.event_71,
	i_p.event_72,
	i_p.event_73,
	i_p.event_74,
	i_p.event_75,
	i_p.event_76,
	i_p.event_77,
	i_p.event_78,
	i_p.event_79,
	i_p.event_80,
	i_p.event_81,
	i_p.event_82,
	i_p.event_83,
	i_p.event_84,
	i_p.event_85,
	i_p.event_86,
	i_p.event_87,
	i_p.event_88,
	i_p.event_89,
	i_p.event_90,
	i_p.event_91,
	i_p.event_92,
	i_p.event_93,
	i_p.event_94,
	i_p.event_95,
	i_p.event_96,
	i_p.event_97,
	i_p.event_98,
	i_p.event_99,
	i_p.event_100,
	i_p.event_101,
	i_p.event_102,
	i_p.event_103,
	i_p.event_104,
	i_p.event_105,
	i_p.event_106,
	i_p.event_107,
	i_p.event_108,
	i_p.event_109,
	i_p.event_110,
	i_p.event_111,
	i_p.event_112,
	i_p.event_113,
	i_p.event_114,
	i_p.event_115,
	i_p.event_116,
	i_p.event_117,
	i_p.event_118,
	i_p.event_119,
	i_p.event_120,
	i_p.event_121,
	i_p.event_122,
	i_p.event_123,
	i_p.event_124,
	i_p.event_125,
	i_p.event_126,
	i_p.event_127,
	i_p.event_128,
	i_p.event_129,
	i_p.event_130,
	i_p.event_131,
	i_p.event_132,
	i_p.event_133,
	i_p.event_134,
	i_p.event_135,
	i_p.event_136,
	i_p.event_137,
	i_p.event_138,
	i_p.event_139,
	i_p.event_140,
	i_p.event_141,
	i_p.event_142,
	i_p.event_143,
	i_p.event_144,
	i_p.event_145,
	i_p.event_146,
	i_p.event_147,
	i_p.event_148,
	i_p.event_149,
	i_p.event_150,
	i_p.event_151,
	i_p.event_152,
	i_p.event_153,
	i_p.event_154,
	i_p.event_155,
	i_p.event_156,
	i_p.event_157,
	i_p.event_158,
	i_p.event_159,
	i_p.event_160,
	i_p.event_161,
	i_p.event_162,
	i_p.event_163,
	i_p.event_164,
	i_p.event_165,
	i_p.event_166,
	i_p.event_167,
	i_p.event_168,
	i_p.event_169,
	i_p.event_170,
	i_p.event_171,
	i_p.event_172,
	i_p.event_173,
	i_p.event_174,
	i_p.event_175,
	i_p.event_176,
	i_p.event_177,
	i_p.event_178,
	i_p.event_179,
	i_p.event_180,
	i_p.event_181,
	i_p.event_182,
	i_p.event_183,
	i_p.event_184,
	i_p.event_185,
	i_p.event_186,
	i_p.event_187,
	i_p.event_188,
	i_p.event_189,
	i_p.event_190,
	i_p.event_191,
	i_p.event_192,
	i_p.event_193,
	i_p.event_194,
	i_p.event_195,
	i_p.event_196,
	i_p.event_197,
	i_p.event_198,
	i_p.event_199,
	i_p.event_200,
	i_p.event_201,
	i_p.event_202,
	i_p.event_203,
	i_p.event_204,
	i_p.event_205,
	i_p.event_206,
	i_p.event_207,
	i_p.event_208,
	i_p.event_209,
	i_p.event_210,
	i_p.event_211,
	i_p.event_212,
	i_p.event_213,
	i_p.event_214,
	i_p.event_215,
	i_p.event_216,
	i_p.event_217,
	i_p.event_218,
	i_p.event_219,
	i_p.event_220,
	i_p.event_221,
	i_p.event_222,
	i_p.event_223,
	i_p.event_224,
	i_p.event_225,
	i_p.event_226,
	i_p.event_227,
	i_p.event_228,
	i_p.event_229,
	i_p.event_230,
	i_p.event_231,
	i_p.event_232,
	i_p.event_233,
	i_p.event_234,
	i_p.event_235,
	i_p.event_236,
	i_p.event_237,
	i_p.event_238,
	i_p.event_239,
	i_p.event_240,
	i_p.event_241,
	i_p.event_242,
	i_p.event_243,
	i_p.event_244,
	i_p.event_245,
	i_p.event_246,
	i_p.event_247,
	i_p.event_248,
	i_p.event_249,
	i_p.event_250,
	i_p.event_251,
	i_p.event_252,
	i_p.event_253,
	i_p.event_254,
	i_p.event_255,
	i_p.event_256,
	i_p.event_257,
	i_p.event_258,
	i_p.event_259,
	i_p.event_260,
	i_p.event_261,
	i_p.event_262,
	i_p.event_263,
	i_p.event_264,
	i_p.event_265,
	i_p.event_266,
	i_p.event_267,
	i_p.event_268,
	i_p.event_269,
	i_p.event_270,
	i_p.event_271,
	i_p.event_272,
	i_p.event_273,
	i_p.event_274,
	i_p.event_275,
	i_p.event_276,
	i_p.event_277,
	i_p.event_278,
	i_p.event_279,
	i_p.event_280,
	i_p.event_281,
	i_p.event_282,
	i_p.event_283,
	i_p.event_284,
	i_p.event_285,
	i_p.event_286,
	i_p.event_287,
	i_p.event_288,
	i_p.event_289,
	i_p.event_290,
	i_p.event_291,
	i_p.event_292,
	i_p.event_293,
	i_p.event_294,
	i_p.event_295,
	i_p.event_296,
	i_p.event_297,
	i_p.event_298,
	i_p.event_299,
	i_p.event_300,
	i_p.event_301
from
	incident_pivot_sum as i_p
join object_with_work_dates as o_d on
	i_p.unom = o_d.unom
	and i_p.date_ext_created between o_d.prev_date_end and o_d.fact_date_start;

drop table if exists incident_pivot_sum_final_gr_bydate;

create table incident_pivot_sum_final_gr_bydate as
select
	work_type_id,
	unom,
	fact_date_start,
	sum(cnt) as cnt,
	sum(asupr) as asupr,
	sum(gormost) as gormost,
	sum(edc) as edc,
	sum(mgi) as mgi,
	sum(cafap) as cafap,
	sum(mos_gas) as mos_gas,
	sum(mvk) as mvk,
	sum(ng) as ng,
	sum(event_1) as event_1,
	sum(event_2) as event_2,
	sum(event_3) as event_3,
	sum(event_4) as event_4,
	sum(event_5) as event_5,
	sum(event_6) as event_6,
	sum(event_7) as event_7,
	sum(event_8) as event_8,
	sum(event_9) as event_9,
	sum(event_10) as event_10,
	sum(event_11) as event_11,
	sum(event_12) as event_12,
	sum(event_13) as event_13,
	sum(event_14) as event_14,
	sum(event_15) as event_15,
	sum(event_16) as event_16,
	sum(event_17) as event_17,
	sum(event_18) as event_18,
	sum(event_19) as event_19,
	sum(event_20) as event_20,
	sum(event_21) as event_21,
	sum(event_22) as event_22,
	sum(event_23) as event_23,
	sum(event_24) as event_24,
	sum(event_25) as event_25,
	sum(event_26) as event_26,
	sum(event_27) as event_27,
	sum(event_28) as event_28,
	sum(event_29) as event_29,
	sum(event_30) as event_30,
	sum(event_31) as event_31,
	sum(event_32) as event_32,
	sum(event_33) as event_33,
	sum(event_34) as event_34,
	sum(event_35) as event_35,
	sum(event_36) as event_36,
	sum(event_37) as event_37,
	sum(event_38) as event_38,
	sum(event_39) as event_39,
	sum(event_40) as event_40,
	sum(event_41) as event_41,
	sum(event_42) as event_42,
	sum(event_43) as event_43,
	sum(event_44) as event_44,
	sum(event_45) as event_45,
	sum(event_46) as event_46,
	sum(event_47) as event_47,
	sum(event_48) as event_48,
	sum(event_49) as event_49,
	sum(event_50) as event_50,
	sum(event_51) as event_51,
	sum(event_52) as event_52,
	sum(event_53) as event_53,
	sum(event_54) as event_54,
	sum(event_55) as event_55,
	sum(event_56) as event_56,
	sum(event_57) as event_57,
	sum(event_58) as event_58,
	sum(event_59) as event_59,
	sum(event_60) as event_60,
	sum(event_61) as event_61,
	sum(event_62) as event_62,
	sum(event_63) as event_63,
	sum(event_64) as event_64,
	sum(event_65) as event_65,
	sum(event_66) as event_66,
	sum(event_67) as event_67,
	sum(event_68) as event_68,
	sum(event_69) as event_69,
	sum(event_70) as event_70,
	sum(event_71) as event_71,
	sum(event_72) as event_72,
	sum(event_73) as event_73,
	sum(event_74) as event_74,
	sum(event_75) as event_75,
	sum(event_76) as event_76,
	sum(event_77) as event_77,
	sum(event_78) as event_78,
	sum(event_79) as event_79,
	sum(event_80) as event_80,
	sum(event_81) as event_81,
	sum(event_82) as event_82,
	sum(event_83) as event_83,
	sum(event_84) as event_84,
	sum(event_85) as event_85,
	sum(event_86) as event_86,
	sum(event_87) as event_87,
	sum(event_88) as event_88,
	sum(event_89) as event_89,
	sum(event_90) as event_90,
	sum(event_91) as event_91,
	sum(event_92) as event_92,
	sum(event_93) as event_93,
	sum(event_94) as event_94,
	sum(event_95) as event_95,
	sum(event_96) as event_96,
	sum(event_97) as event_97,
	sum(event_98) as event_98,
	sum(event_99) as event_99,
	sum(event_100) as event_100,
	sum(event_101) as event_101,
	sum(event_102) as event_102,
	sum(event_103) as event_103,
	sum(event_104) as event_104,
	sum(event_105) as event_105,
	sum(event_106) as event_106,
	sum(event_107) as event_107,
	sum(event_108) as event_108,
	sum(event_109) as event_109,
	sum(event_110) as event_110,
	sum(event_111) as event_111,
	sum(event_112) as event_112,
	sum(event_113) as event_113,
	sum(event_114) as event_114,
	sum(event_115) as event_115,
	sum(event_116) as event_116,
	sum(event_117) as event_117,
	sum(event_118) as event_118,
	sum(event_119) as event_119,
	sum(event_120) as event_120,
	sum(event_121) as event_121,
	sum(event_122) as event_122,
	sum(event_123) as event_123,
	sum(event_124) as event_124,
	sum(event_125) as event_125,
	sum(event_126) as event_126,
	sum(event_127) as event_127,
	sum(event_128) as event_128,
	sum(event_129) as event_129,
	sum(event_130) as event_130,
	sum(event_131) as event_131,
	sum(event_132) as event_132,
	sum(event_133) as event_133,
	sum(event_134) as event_134,
	sum(event_135) as event_135,
	sum(event_136) as event_136,
	sum(event_137) as event_137,
	sum(event_138) as event_138,
	sum(event_139) as event_139,
	sum(event_140) as event_140,
	sum(event_141) as event_141,
	sum(event_142) as event_142,
	sum(event_143) as event_143,
	sum(event_144) as event_144,
	sum(event_145) as event_145,
	sum(event_146) as event_146,
	sum(event_147) as event_147,
	sum(event_148) as event_148,
	sum(event_149) as event_149,
	sum(event_150) as event_150,
	sum(event_151) as event_151,
	sum(event_152) as event_152,
	sum(event_153) as event_153,
	sum(event_154) as event_154,
	sum(event_155) as event_155,
	sum(event_156) as event_156,
	sum(event_157) as event_157,
	sum(event_158) as event_158,
	sum(event_159) as event_159,
	sum(event_160) as event_160,
	sum(event_161) as event_161,
	sum(event_162) as event_162,
	sum(event_163) as event_163,
	sum(event_164) as event_164,
	sum(event_165) as event_165,
	sum(event_166) as event_166,
	sum(event_167) as event_167,
	sum(event_168) as event_168,
	sum(event_169) as event_169,
	sum(event_170) as event_170,
	sum(event_171) as event_171,
	sum(event_172) as event_172,
	sum(event_173) as event_173,
	sum(event_174) as event_174,
	sum(event_175) as event_175,
	sum(event_176) as event_176,
	sum(event_177) as event_177,
	sum(event_178) as event_178,
	sum(event_179) as event_179,
	sum(event_180) as event_180,
	sum(event_181) as event_181,
	sum(event_182) as event_182,
	sum(event_183) as event_183,
	sum(event_184) as event_184,
	sum(event_185) as event_185,
	sum(event_186) as event_186,
	sum(event_187) as event_187,
	sum(event_188) as event_188,
	sum(event_189) as event_189,
	sum(event_190) as event_190,
	sum(event_191) as event_191,
	sum(event_192) as event_192,
	sum(event_193) as event_193,
	sum(event_194) as event_194,
	sum(event_195) as event_195,
	sum(event_196) as event_196,
	sum(event_197) as event_197,
	sum(event_198) as event_198,
	sum(event_199) as event_199,
	sum(event_200) as event_200,
	sum(event_201) as event_201,
	sum(event_202) as event_202,
	sum(event_203) as event_203,
	sum(event_204) as event_204,
	sum(event_205) as event_205,
	sum(event_206) as event_206,
	sum(event_207) as event_207,
	sum(event_208) as event_208,
	sum(event_209) as event_209,
	sum(event_210) as event_210,
	sum(event_211) as event_211,
	sum(event_212) as event_212,
	sum(event_213) as event_213,
	sum(event_214) as event_214,
	sum(event_215) as event_215,
	sum(event_216) as event_216,
	sum(event_217) as event_217,
	sum(event_218) as event_218,
	sum(event_219) as event_219,
	sum(event_220) as event_220,
	sum(event_221) as event_221,
	sum(event_222) as event_222,
	sum(event_223) as event_223,
	sum(event_224) as event_224,
	sum(event_225) as event_225,
	sum(event_226) as event_226,
	sum(event_227) as event_227,
	sum(event_228) as event_228,
	sum(event_229) as event_229,
	sum(event_230) as event_230,
	sum(event_231) as event_231,
	sum(event_232) as event_232,
	sum(event_233) as event_233,
	sum(event_234) as event_234,
	sum(event_235) as event_235,
	sum(event_236) as event_236,
	sum(event_237) as event_237,
	sum(event_238) as event_238,
	sum(event_239) as event_239,
	sum(event_240) as event_240,
	sum(event_241) as event_241,
	sum(event_242) as event_242,
	sum(event_243) as event_243,
	sum(event_244) as event_244,
	sum(event_245) as event_245,
	sum(event_246) as event_246,
	sum(event_247) as event_247,
	sum(event_248) as event_248,
	sum(event_249) as event_249,
	sum(event_250) as event_250,
	sum(event_251) as event_251,
	sum(event_252) as event_252,
	sum(event_253) as event_253,
	sum(event_254) as event_254,
	sum(event_255) as event_255,
	sum(event_256) as event_256,
	sum(event_257) as event_257,
	sum(event_258) as event_258,
	sum(event_259) as event_259,
	sum(event_260) as event_260,
	sum(event_261) as event_261,
	sum(event_262) as event_262,
	sum(event_263) as event_263,
	sum(event_264) as event_264,
	sum(event_265) as event_265,
	sum(event_266) as event_266,
	sum(event_267) as event_267,
	sum(event_268) as event_268,
	sum(event_269) as event_269,
	sum(event_270) as event_270,
	sum(event_271) as event_271,
	sum(event_272) as event_272,
	sum(event_273) as event_273,
	sum(event_274) as event_274,
	sum(event_275) as event_275,
	sum(event_276) as event_276,
	sum(event_277) as event_277,
	sum(event_278) as event_278,
	sum(event_279) as event_279,
	sum(event_280) as event_280,
	sum(event_281) as event_281,
	sum(event_282) as event_282,
	sum(event_283) as event_283,
	sum(event_284) as event_284,
	sum(event_285) as event_285,
	sum(event_286) as event_286,
	sum(event_287) as event_287,
	sum(event_288) as event_288,
	sum(event_289) as event_289,
	sum(event_290) as event_290,
	sum(event_291) as event_291,
	sum(event_292) as event_292,
	sum(event_293) as event_293,
	sum(event_294) as event_294,
	sum(event_295) as event_295,
	sum(event_296) as event_296,
	sum(event_297) as event_297,
	sum(event_298) as event_298,
	sum(event_299) as event_299,
	sum(event_300) as event_300,
	sum(event_301) as event_301
from
	public.incident_pivot_sum_final
group by
	work_type_id,
	unom,
	fact_date_start;

drop table if exists incident_pivot_sum_final_gr_byunom;

create table incident_pivot_sum_final_gr_byunom as
select
	unom,
	sum(cnt) as cnt,
	sum(asupr) as asupr,
	sum(gormost) as gormost,
	sum(edc) as edc,
	sum(mgi) as mgi,
	sum(cafap) as cafap,
	sum(mos_gas) as mos_gas,
	sum(mvk) as mvk,
	sum(ng) as ng,
	sum(event_1) as event_1,
	sum(event_2) as event_2,
	sum(event_3) as event_3,
	sum(event_4) as event_4,
	sum(event_5) as event_5,
	sum(event_6) as event_6,
	sum(event_7) as event_7,
	sum(event_8) as event_8,
	sum(event_9) as event_9,
	sum(event_10) as event_10,
	sum(event_11) as event_11,
	sum(event_12) as event_12,
	sum(event_13) as event_13,
	sum(event_14) as event_14,
	sum(event_15) as event_15,
	sum(event_16) as event_16,
	sum(event_17) as event_17,
	sum(event_18) as event_18,
	sum(event_19) as event_19,
	sum(event_20) as event_20,
	sum(event_21) as event_21,
	sum(event_22) as event_22,
	sum(event_23) as event_23,
	sum(event_24) as event_24,
	sum(event_25) as event_25,
	sum(event_26) as event_26,
	sum(event_27) as event_27,
	sum(event_28) as event_28,
	sum(event_29) as event_29,
	sum(event_30) as event_30,
	sum(event_31) as event_31,
	sum(event_32) as event_32,
	sum(event_33) as event_33,
	sum(event_34) as event_34,
	sum(event_35) as event_35,
	sum(event_36) as event_36,
	sum(event_37) as event_37,
	sum(event_38) as event_38,
	sum(event_39) as event_39,
	sum(event_40) as event_40,
	sum(event_41) as event_41,
	sum(event_42) as event_42,
	sum(event_43) as event_43,
	sum(event_44) as event_44,
	sum(event_45) as event_45,
	sum(event_46) as event_46,
	sum(event_47) as event_47,
	sum(event_48) as event_48,
	sum(event_49) as event_49,
	sum(event_50) as event_50,
	sum(event_51) as event_51,
	sum(event_52) as event_52,
	sum(event_53) as event_53,
	sum(event_54) as event_54,
	sum(event_55) as event_55,
	sum(event_56) as event_56,
	sum(event_57) as event_57,
	sum(event_58) as event_58,
	sum(event_59) as event_59,
	sum(event_60) as event_60,
	sum(event_61) as event_61,
	sum(event_62) as event_62,
	sum(event_63) as event_63,
	sum(event_64) as event_64,
	sum(event_65) as event_65,
	sum(event_66) as event_66,
	sum(event_67) as event_67,
	sum(event_68) as event_68,
	sum(event_69) as event_69,
	sum(event_70) as event_70,
	sum(event_71) as event_71,
	sum(event_72) as event_72,
	sum(event_73) as event_73,
	sum(event_74) as event_74,
	sum(event_75) as event_75,
	sum(event_76) as event_76,
	sum(event_77) as event_77,
	sum(event_78) as event_78,
	sum(event_79) as event_79,
	sum(event_80) as event_80,
	sum(event_81) as event_81,
	sum(event_82) as event_82,
	sum(event_83) as event_83,
	sum(event_84) as event_84,
	sum(event_85) as event_85,
	sum(event_86) as event_86,
	sum(event_87) as event_87,
	sum(event_88) as event_88,
	sum(event_89) as event_89,
	sum(event_90) as event_90,
	sum(event_91) as event_91,
	sum(event_92) as event_92,
	sum(event_93) as event_93,
	sum(event_94) as event_94,
	sum(event_95) as event_95,
	sum(event_96) as event_96,
	sum(event_97) as event_97,
	sum(event_98) as event_98,
	sum(event_99) as event_99,
	sum(event_100) as event_100,
	sum(event_101) as event_101,
	sum(event_102) as event_102,
	sum(event_103) as event_103,
	sum(event_104) as event_104,
	sum(event_105) as event_105,
	sum(event_106) as event_106,
	sum(event_107) as event_107,
	sum(event_108) as event_108,
	sum(event_109) as event_109,
	sum(event_110) as event_110,
	sum(event_111) as event_111,
	sum(event_112) as event_112,
	sum(event_113) as event_113,
	sum(event_114) as event_114,
	sum(event_115) as event_115,
	sum(event_116) as event_116,
	sum(event_117) as event_117,
	sum(event_118) as event_118,
	sum(event_119) as event_119,
	sum(event_120) as event_120,
	sum(event_121) as event_121,
	sum(event_122) as event_122,
	sum(event_123) as event_123,
	sum(event_124) as event_124,
	sum(event_125) as event_125,
	sum(event_126) as event_126,
	sum(event_127) as event_127,
	sum(event_128) as event_128,
	sum(event_129) as event_129,
	sum(event_130) as event_130,
	sum(event_131) as event_131,
	sum(event_132) as event_132,
	sum(event_133) as event_133,
	sum(event_134) as event_134,
	sum(event_135) as event_135,
	sum(event_136) as event_136,
	sum(event_137) as event_137,
	sum(event_138) as event_138,
	sum(event_139) as event_139,
	sum(event_140) as event_140,
	sum(event_141) as event_141,
	sum(event_142) as event_142,
	sum(event_143) as event_143,
	sum(event_144) as event_144,
	sum(event_145) as event_145,
	sum(event_146) as event_146,
	sum(event_147) as event_147,
	sum(event_148) as event_148,
	sum(event_149) as event_149,
	sum(event_150) as event_150,
	sum(event_151) as event_151,
	sum(event_152) as event_152,
	sum(event_153) as event_153,
	sum(event_154) as event_154,
	sum(event_155) as event_155,
	sum(event_156) as event_156,
	sum(event_157) as event_157,
	sum(event_158) as event_158,
	sum(event_159) as event_159,
	sum(event_160) as event_160,
	sum(event_161) as event_161,
	sum(event_162) as event_162,
	sum(event_163) as event_163,
	sum(event_164) as event_164,
	sum(event_165) as event_165,
	sum(event_166) as event_166,
	sum(event_167) as event_167,
	sum(event_168) as event_168,
	sum(event_169) as event_169,
	sum(event_170) as event_170,
	sum(event_171) as event_171,
	sum(event_172) as event_172,
	sum(event_173) as event_173,
	sum(event_174) as event_174,
	sum(event_175) as event_175,
	sum(event_176) as event_176,
	sum(event_177) as event_177,
	sum(event_178) as event_178,
	sum(event_179) as event_179,
	sum(event_180) as event_180,
	sum(event_181) as event_181,
	sum(event_182) as event_182,
	sum(event_183) as event_183,
	sum(event_184) as event_184,
	sum(event_185) as event_185,
	sum(event_186) as event_186,
	sum(event_187) as event_187,
	sum(event_188) as event_188,
	sum(event_189) as event_189,
	sum(event_190) as event_190,
	sum(event_191) as event_191,
	sum(event_192) as event_192,
	sum(event_193) as event_193,
	sum(event_194) as event_194,
	sum(event_195) as event_195,
	sum(event_196) as event_196,
	sum(event_197) as event_197,
	sum(event_198) as event_198,
	sum(event_199) as event_199,
	sum(event_200) as event_200,
	sum(event_201) as event_201,
	sum(event_202) as event_202,
	sum(event_203) as event_203,
	sum(event_204) as event_204,
	sum(event_205) as event_205,
	sum(event_206) as event_206,
	sum(event_207) as event_207,
	sum(event_208) as event_208,
	sum(event_209) as event_209,
	sum(event_210) as event_210,
	sum(event_211) as event_211,
	sum(event_212) as event_212,
	sum(event_213) as event_213,
	sum(event_214) as event_214,
	sum(event_215) as event_215,
	sum(event_216) as event_216,
	sum(event_217) as event_217,
	sum(event_218) as event_218,
	sum(event_219) as event_219,
	sum(event_220) as event_220,
	sum(event_221) as event_221,
	sum(event_222) as event_222,
	sum(event_223) as event_223,
	sum(event_224) as event_224,
	sum(event_225) as event_225,
	sum(event_226) as event_226,
	sum(event_227) as event_227,
	sum(event_228) as event_228,
	sum(event_229) as event_229,
	sum(event_230) as event_230,
	sum(event_231) as event_231,
	sum(event_232) as event_232,
	sum(event_233) as event_233,
	sum(event_234) as event_234,
	sum(event_235) as event_235,
	sum(event_236) as event_236,
	sum(event_237) as event_237,
	sum(event_238) as event_238,
	sum(event_239) as event_239,
	sum(event_240) as event_240,
	sum(event_241) as event_241,
	sum(event_242) as event_242,
	sum(event_243) as event_243,
	sum(event_244) as event_244,
	sum(event_245) as event_245,
	sum(event_246) as event_246,
	sum(event_247) as event_247,
	sum(event_248) as event_248,
	sum(event_249) as event_249,
	sum(event_250) as event_250,
	sum(event_251) as event_251,
	sum(event_252) as event_252,
	sum(event_253) as event_253,
	sum(event_254) as event_254,
	sum(event_255) as event_255,
	sum(event_256) as event_256,
	sum(event_257) as event_257,
	sum(event_258) as event_258,
	sum(event_259) as event_259,
	sum(event_260) as event_260,
	sum(event_261) as event_261,
	sum(event_262) as event_262,
	sum(event_263) as event_263,
	sum(event_264) as event_264,
	sum(event_265) as event_265,
	sum(event_266) as event_266,
	sum(event_267) as event_267,
	sum(event_268) as event_268,
	sum(event_269) as event_269,
	sum(event_270) as event_270,
	sum(event_271) as event_271,
	sum(event_272) as event_272,
	sum(event_273) as event_273,
	sum(event_274) as event_274,
	sum(event_275) as event_275,
	sum(event_276) as event_276,
	sum(event_277) as event_277,
	sum(event_278) as event_278,
	sum(event_279) as event_279,
	sum(event_280) as event_280,
	sum(event_281) as event_281,
	sum(event_282) as event_282,
	sum(event_283) as event_283,
	sum(event_284) as event_284,
	sum(event_285) as event_285,
	sum(event_286) as event_286,
	sum(event_287) as event_287,
	sum(event_288) as event_288,
	sum(event_289) as event_289,
	sum(event_290) as event_290,
	sum(event_291) as event_291,
	sum(event_292) as event_292,
	sum(event_293) as event_293,
	sum(event_294) as event_294,
	sum(event_295) as event_295,
	sum(event_296) as event_296,
	sum(event_297) as event_297,
	sum(event_298) as event_298,
	sum(event_299) as event_299,
	sum(event_300) as event_300,
	sum(event_301) as event_301
from
	public.incident_pivot_sum
group by 
	unom;

create index unom_fact_date_start_incident_pivot_sum_final_gr_bydate on
incident_pivot_sum_final_gr_bydate (unom,
work_type_id,
fact_date_start);

create index unom_fact_date_start_incident_pivot_sum_final_gr_byunom on
incident_pivot_sum_final_gr_byunom (unom);

create index unom_fact_date_start_object_with_work on
object_with_work (unom,
work_type_id,
fact_date_start);

drop table if exists for_model_prefinal;

create table for_model_prefinal as
select
	distinct coalesce(o_w.work_type_id,
	-1) as work_type_id,
	o_w.unom,
	o_w.col_754,
	o_w.col_755,
	o_w.col_756,
	o_w.col_757,
	o_w.col_758_id,
	o_w.col_759,
	o_w.col_760,
	o_w.col_761,
	o_w.col_762,
	o_w.col_763,
	o_w.col_764,
	o_w.col_765,
	o_w.col_766,
	o_w.col_767,
	o_w.col_769_id,
	o_w.col_770_id,
	o_w.col_771,
	o_w.col_772,
	o_w.col_775_id,
	o_w.col_781_id,
	o_w.col_2156_id,
	o_w.col_2463_id,
	o_w.col_3163_id,
	o_w.col_3243_id,
	o_w.col_3363,
	o_w.col_103506_id,
	coalesce(i_p.cnt,
	i_p_wo.cnt) as cnt,
	coalesce(i_p.asupr,
	i_p_wo.asupr) as asupr,
	coalesce(i_p.gormost,
	i_p_wo.gormost) as gormost,
	coalesce(i_p.edc,
	i_p_wo.edc) as edc,
	coalesce(i_p.mgi,
	i_p_wo.mgi) as mgi,
	coalesce(i_p.cafap,
	i_p_wo.cafap) as cafap,
	coalesce(i_p.mos_gas,
	i_p_wo.mos_gas) as mos_gas,
	coalesce(i_p.mvk,
	i_p_wo.mvk) as mvk,
	coalesce(i_p.ng,
	i_p_wo.ng) as ng,
	coalesce(i_p.event_1,
	i_p_wo.event_1) as event_1,
	coalesce(i_p.event_2,
	i_p_wo.event_2) as event_2,
	coalesce(i_p.event_3,
	i_p_wo.event_3) as event_3,
	coalesce(i_p.event_4,
	i_p_wo.event_4) as event_4,
	coalesce(i_p.event_5,
	i_p_wo.event_5) as event_5,
	coalesce(i_p.event_6,
	i_p_wo.event_6) as event_6,
	coalesce(i_p.event_7,
	i_p_wo.event_7) as event_7,
	coalesce(i_p.event_8,
	i_p_wo.event_8) as event_8,
	coalesce(i_p.event_9,
	i_p_wo.event_9) as event_9,
	coalesce(i_p.event_10,
	i_p_wo.event_10) as event_10,
	coalesce(i_p.event_11,
	i_p_wo.event_11) as event_11,
	coalesce(i_p.event_12,
	i_p_wo.event_12) as event_12,
	coalesce(i_p.event_13,
	i_p_wo.event_13) as event_13,
	coalesce(i_p.event_14,
	i_p_wo.event_14) as event_14,
	coalesce(i_p.event_15,
	i_p_wo.event_15) as event_15,
	coalesce(i_p.event_16,
	i_p_wo.event_16) as event_16,
	coalesce(i_p.event_17,
	i_p_wo.event_17) as event_17,
	coalesce(i_p.event_18,
	i_p_wo.event_18) as event_18,
	coalesce(i_p.event_19,
	i_p_wo.event_19) as event_19,
	coalesce(i_p.event_20,
	i_p_wo.event_20) as event_20,
	coalesce(i_p.event_21,
	i_p_wo.event_21) as event_21,
	coalesce(i_p.event_22,
	i_p_wo.event_22) as event_22,
	coalesce(i_p.event_23,
	i_p_wo.event_23) as event_23,
	coalesce(i_p.event_24,
	i_p_wo.event_24) as event_24,
	coalesce(i_p.event_25,
	i_p_wo.event_25) as event_25,
	coalesce(i_p.event_26,
	i_p_wo.event_26) as event_26,
	coalesce(i_p.event_27,
	i_p_wo.event_27) as event_27,
	coalesce(i_p.event_28,
	i_p_wo.event_28) as event_28,
	coalesce(i_p.event_29,
	i_p_wo.event_29) as event_29,
	coalesce(i_p.event_30,
	i_p_wo.event_30) as event_30,
	coalesce(i_p.event_31,
	i_p_wo.event_31) as event_31,
	coalesce(i_p.event_32,
	i_p_wo.event_32) as event_32,
	coalesce(i_p.event_33,
	i_p_wo.event_33) as event_33,
	coalesce(i_p.event_34,
	i_p_wo.event_34) as event_34,
	coalesce(i_p.event_35,
	i_p_wo.event_35) as event_35,
	coalesce(i_p.event_36,
	i_p_wo.event_36) as event_36,
	coalesce(i_p.event_37,
	i_p_wo.event_37) as event_37,
	coalesce(i_p.event_38,
	i_p_wo.event_38) as event_38,
	coalesce(i_p.event_39,
	i_p_wo.event_39) as event_39,
	coalesce(i_p.event_40,
	i_p_wo.event_40) as event_40,
	coalesce(i_p.event_41,
	i_p_wo.event_41) as event_41,
	coalesce(i_p.event_42,
	i_p_wo.event_42) as event_42,
	coalesce(i_p.event_43,
	i_p_wo.event_43) as event_43,
	coalesce(i_p.event_44,
	i_p_wo.event_44) as event_44,
	coalesce(i_p.event_45,
	i_p_wo.event_45) as event_45,
	coalesce(i_p.event_46,
	i_p_wo.event_46) as event_46,
	coalesce(i_p.event_47,
	i_p_wo.event_47) as event_47,
	coalesce(i_p.event_48,
	i_p_wo.event_48) as event_48,
	coalesce(i_p.event_49,
	i_p_wo.event_49) as event_49,
	coalesce(i_p.event_50,
	i_p_wo.event_50) as event_50,
	coalesce(i_p.event_51,
	i_p_wo.event_51) as event_51,
	coalesce(i_p.event_52,
	i_p_wo.event_52) as event_52,
	coalesce(i_p.event_53,
	i_p_wo.event_53) as event_53,
	coalesce(i_p.event_54,
	i_p_wo.event_54) as event_54,
	coalesce(i_p.event_55,
	i_p_wo.event_55) as event_55,
	coalesce(i_p.event_56,
	i_p_wo.event_56) as event_56,
	coalesce(i_p.event_57,
	i_p_wo.event_57) as event_57,
	coalesce(i_p.event_58,
	i_p_wo.event_58) as event_58,
	coalesce(i_p.event_59,
	i_p_wo.event_59) as event_59,
	coalesce(i_p.event_60,
	i_p_wo.event_60) as event_60,
	coalesce(i_p.event_61,
	i_p_wo.event_61) as event_61,
	coalesce(i_p.event_62,
	i_p_wo.event_62) as event_62,
	coalesce(i_p.event_63,
	i_p_wo.event_63) as event_63,
	coalesce(i_p.event_64,
	i_p_wo.event_64) as event_64,
	coalesce(i_p.event_65,
	i_p_wo.event_65) as event_65,
	coalesce(i_p.event_66,
	i_p_wo.event_66) as event_66,
	coalesce(i_p.event_67,
	i_p_wo.event_67) as event_67,
	coalesce(i_p.event_68,
	i_p_wo.event_68) as event_68,
	coalesce(i_p.event_69,
	i_p_wo.event_69) as event_69,
	coalesce(i_p.event_70,
	i_p_wo.event_70) as event_70,
	coalesce(i_p.event_71,
	i_p_wo.event_71) as event_71,
	coalesce(i_p.event_72,
	i_p_wo.event_72) as event_72,
	coalesce(i_p.event_73,
	i_p_wo.event_73) as event_73,
	coalesce(i_p.event_74,
	i_p_wo.event_74) as event_74,
	coalesce(i_p.event_75,
	i_p_wo.event_75) as event_75,
	coalesce(i_p.event_76,
	i_p_wo.event_76) as event_76,
	coalesce(i_p.event_77,
	i_p_wo.event_77) as event_77,
	coalesce(i_p.event_78,
	i_p_wo.event_78) as event_78,
	coalesce(i_p.event_79,
	i_p_wo.event_79) as event_79,
	coalesce(i_p.event_80,
	i_p_wo.event_80) as event_80,
	coalesce(i_p.event_81,
	i_p_wo.event_81) as event_81,
	coalesce(i_p.event_82,
	i_p_wo.event_82) as event_82,
	coalesce(i_p.event_83,
	i_p_wo.event_83) as event_83,
	coalesce(i_p.event_84,
	i_p_wo.event_84) as event_84,
	coalesce(i_p.event_85,
	i_p_wo.event_85) as event_85,
	coalesce(i_p.event_86,
	i_p_wo.event_86) as event_86,
	coalesce(i_p.event_87,
	i_p_wo.event_87) as event_87,
	coalesce(i_p.event_88,
	i_p_wo.event_88) as event_88,
	coalesce(i_p.event_89,
	i_p_wo.event_89) as event_89,
	coalesce(i_p.event_90,
	i_p_wo.event_90) as event_90,
	coalesce(i_p.event_91,
	i_p_wo.event_91) as event_91,
	coalesce(i_p.event_92,
	i_p_wo.event_92) as event_92,
	coalesce(i_p.event_93,
	i_p_wo.event_93) as event_93,
	coalesce(i_p.event_94,
	i_p_wo.event_94) as event_94,
	coalesce(i_p.event_95,
	i_p_wo.event_95) as event_95,
	coalesce(i_p.event_96,
	i_p_wo.event_96) as event_96,
	coalesce(i_p.event_97,
	i_p_wo.event_97) as event_97,
	coalesce(i_p.event_98,
	i_p_wo.event_98) as event_98,
	coalesce(i_p.event_99,
	i_p_wo.event_99) as event_99,
	coalesce(i_p.event_100,
	i_p_wo.event_100) as event_100,
	coalesce(i_p.event_101,
	i_p_wo.event_101) as event_101,
	coalesce(i_p.event_102,
	i_p_wo.event_102) as event_102,
	coalesce(i_p.event_103,
	i_p_wo.event_103) as event_103,
	coalesce(i_p.event_104,
	i_p_wo.event_104) as event_104,
	coalesce(i_p.event_105,
	i_p_wo.event_105) as event_105,
	coalesce(i_p.event_106,
	i_p_wo.event_106) as event_106,
	coalesce(i_p.event_107,
	i_p_wo.event_107) as event_107,
	coalesce(i_p.event_108,
	i_p_wo.event_108) as event_108,
	coalesce(i_p.event_109,
	i_p_wo.event_109) as event_109,
	coalesce(i_p.event_110,
	i_p_wo.event_110) as event_110,
	coalesce(i_p.event_111,
	i_p_wo.event_111) as event_111,
	coalesce(i_p.event_112,
	i_p_wo.event_112) as event_112,
	coalesce(i_p.event_113,
	i_p_wo.event_113) as event_113,
	coalesce(i_p.event_114,
	i_p_wo.event_114) as event_114,
	coalesce(i_p.event_115,
	i_p_wo.event_115) as event_115,
	coalesce(i_p.event_116,
	i_p_wo.event_116) as event_116,
	coalesce(i_p.event_117,
	i_p_wo.event_117) as event_117,
	coalesce(i_p.event_118,
	i_p_wo.event_118) as event_118,
	coalesce(i_p.event_119,
	i_p_wo.event_119) as event_119,
	coalesce(i_p.event_120,
	i_p_wo.event_120) as event_120,
	coalesce(i_p.event_121,
	i_p_wo.event_121) as event_121,
	coalesce(i_p.event_122,
	i_p_wo.event_122) as event_122,
	coalesce(i_p.event_123,
	i_p_wo.event_123) as event_123,
	coalesce(i_p.event_124,
	i_p_wo.event_124) as event_124,
	coalesce(i_p.event_125,
	i_p_wo.event_125) as event_125,
	coalesce(i_p.event_126,
	i_p_wo.event_126) as event_126,
	coalesce(i_p.event_127,
	i_p_wo.event_127) as event_127,
	coalesce(i_p.event_128,
	i_p_wo.event_128) as event_128,
	coalesce(i_p.event_129,
	i_p_wo.event_129) as event_129,
	coalesce(i_p.event_130,
	i_p_wo.event_130) as event_130,
	coalesce(i_p.event_131,
	i_p_wo.event_131) as event_131,
	coalesce(i_p.event_132,
	i_p_wo.event_132) as event_132,
	coalesce(i_p.event_133,
	i_p_wo.event_133) as event_133,
	coalesce(i_p.event_134,
	i_p_wo.event_134) as event_134,
	coalesce(i_p.event_135,
	i_p_wo.event_135) as event_135,
	coalesce(i_p.event_136,
	i_p_wo.event_136) as event_136,
	coalesce(i_p.event_137,
	i_p_wo.event_137) as event_137,
	coalesce(i_p.event_138,
	i_p_wo.event_138) as event_138,
	coalesce(i_p.event_139,
	i_p_wo.event_139) as event_139,
	coalesce(i_p.event_140,
	i_p_wo.event_140) as event_140,
	coalesce(i_p.event_141,
	i_p_wo.event_141) as event_141,
	coalesce(i_p.event_142,
	i_p_wo.event_142) as event_142,
	coalesce(i_p.event_143,
	i_p_wo.event_143) as event_143,
	coalesce(i_p.event_144,
	i_p_wo.event_144) as event_144,
	coalesce(i_p.event_145,
	i_p_wo.event_145) as event_145,
	coalesce(i_p.event_146,
	i_p_wo.event_146) as event_146,
	coalesce(i_p.event_147,
	i_p_wo.event_147) as event_147,
	coalesce(i_p.event_148,
	i_p_wo.event_148) as event_148,
	coalesce(i_p.event_149,
	i_p_wo.event_149) as event_149,
	coalesce(i_p.event_150,
	i_p_wo.event_150) as event_150,
	coalesce(i_p.event_151,
	i_p_wo.event_151) as event_151,
	coalesce(i_p.event_152,
	i_p_wo.event_152) as event_152,
	coalesce(i_p.event_153,
	i_p_wo.event_153) as event_153,
	coalesce(i_p.event_154,
	i_p_wo.event_154) as event_154,
	coalesce(i_p.event_155,
	i_p_wo.event_155) as event_155,
	coalesce(i_p.event_156,
	i_p_wo.event_156) as event_156,
	coalesce(i_p.event_157,
	i_p_wo.event_157) as event_157,
	coalesce(i_p.event_158,
	i_p_wo.event_158) as event_158,
	coalesce(i_p.event_159,
	i_p_wo.event_159) as event_159,
	coalesce(i_p.event_160,
	i_p_wo.event_160) as event_160,
	coalesce(i_p.event_161,
	i_p_wo.event_161) as event_161,
	coalesce(i_p.event_162,
	i_p_wo.event_162) as event_162,
	coalesce(i_p.event_163,
	i_p_wo.event_163) as event_163,
	coalesce(i_p.event_164,
	i_p_wo.event_164) as event_164,
	coalesce(i_p.event_165,
	i_p_wo.event_165) as event_165,
	coalesce(i_p.event_166,
	i_p_wo.event_166) as event_166,
	coalesce(i_p.event_167,
	i_p_wo.event_167) as event_167,
	coalesce(i_p.event_168,
	i_p_wo.event_168) as event_168,
	coalesce(i_p.event_169,
	i_p_wo.event_169) as event_169,
	coalesce(i_p.event_170,
	i_p_wo.event_170) as event_170,
	coalesce(i_p.event_171,
	i_p_wo.event_171) as event_171,
	coalesce(i_p.event_172,
	i_p_wo.event_172) as event_172,
	coalesce(i_p.event_173,
	i_p_wo.event_173) as event_173,
	coalesce(i_p.event_174,
	i_p_wo.event_174) as event_174,
	coalesce(i_p.event_175,
	i_p_wo.event_175) as event_175,
	coalesce(i_p.event_176,
	i_p_wo.event_176) as event_176,
	coalesce(i_p.event_177,
	i_p_wo.event_177) as event_177,
	coalesce(i_p.event_178,
	i_p_wo.event_178) as event_178,
	coalesce(i_p.event_179,
	i_p_wo.event_179) as event_179,
	coalesce(i_p.event_180,
	i_p_wo.event_180) as event_180,
	coalesce(i_p.event_181,
	i_p_wo.event_181) as event_181,
	coalesce(i_p.event_182,
	i_p_wo.event_182) as event_182,
	coalesce(i_p.event_183,
	i_p_wo.event_183) as event_183,
	coalesce(i_p.event_184,
	i_p_wo.event_184) as event_184,
	coalesce(i_p.event_185,
	i_p_wo.event_185) as event_185,
	coalesce(i_p.event_186,
	i_p_wo.event_186) as event_186,
	coalesce(i_p.event_187,
	i_p_wo.event_187) as event_187,
	coalesce(i_p.event_188,
	i_p_wo.event_188) as event_188,
	coalesce(i_p.event_189,
	i_p_wo.event_189) as event_189,
	coalesce(i_p.event_190,
	i_p_wo.event_190) as event_190,
	coalesce(i_p.event_191,
	i_p_wo.event_191) as event_191,
	coalesce(i_p.event_192,
	i_p_wo.event_192) as event_192,
	coalesce(i_p.event_193,
	i_p_wo.event_193) as event_193,
	coalesce(i_p.event_194,
	i_p_wo.event_194) as event_194,
	coalesce(i_p.event_195,
	i_p_wo.event_195) as event_195,
	coalesce(i_p.event_196,
	i_p_wo.event_196) as event_196,
	coalesce(i_p.event_197,
	i_p_wo.event_197) as event_197,
	coalesce(i_p.event_198,
	i_p_wo.event_198) as event_198,
	coalesce(i_p.event_199,
	i_p_wo.event_199) as event_199,
	coalesce(i_p.event_200,
	i_p_wo.event_200) as event_200,
	coalesce(i_p.event_201,
	i_p_wo.event_201) as event_201,
	coalesce(i_p.event_202,
	i_p_wo.event_202) as event_202,
	coalesce(i_p.event_203,
	i_p_wo.event_203) as event_203,
	coalesce(i_p.event_204,
	i_p_wo.event_204) as event_204,
	coalesce(i_p.event_205,
	i_p_wo.event_205) as event_205,
	coalesce(i_p.event_206,
	i_p_wo.event_206) as event_206,
	coalesce(i_p.event_207,
	i_p_wo.event_207) as event_207,
	coalesce(i_p.event_208,
	i_p_wo.event_208) as event_208,
	coalesce(i_p.event_209,
	i_p_wo.event_209) as event_209,
	coalesce(i_p.event_210,
	i_p_wo.event_210) as event_210,
	coalesce(i_p.event_211,
	i_p_wo.event_211) as event_211,
	coalesce(i_p.event_212,
	i_p_wo.event_212) as event_212,
	coalesce(i_p.event_213,
	i_p_wo.event_213) as event_213,
	coalesce(i_p.event_214,
	i_p_wo.event_214) as event_214,
	coalesce(i_p.event_215,
	i_p_wo.event_215) as event_215,
	coalesce(i_p.event_216,
	i_p_wo.event_216) as event_216,
	coalesce(i_p.event_217,
	i_p_wo.event_217) as event_217,
	coalesce(i_p.event_218,
	i_p_wo.event_218) as event_218,
	coalesce(i_p.event_219,
	i_p_wo.event_219) as event_219,
	coalesce(i_p.event_220,
	i_p_wo.event_220) as event_220,
	coalesce(i_p.event_221,
	i_p_wo.event_221) as event_221,
	coalesce(i_p.event_222,
	i_p_wo.event_222) as event_222,
	coalesce(i_p.event_223,
	i_p_wo.event_223) as event_223,
	coalesce(i_p.event_224,
	i_p_wo.event_224) as event_224,
	coalesce(i_p.event_225,
	i_p_wo.event_225) as event_225,
	coalesce(i_p.event_226,
	i_p_wo.event_226) as event_226,
	coalesce(i_p.event_227,
	i_p_wo.event_227) as event_227,
	coalesce(i_p.event_228,
	i_p_wo.event_228) as event_228,
	coalesce(i_p.event_229,
	i_p_wo.event_229) as event_229,
	coalesce(i_p.event_230,
	i_p_wo.event_230) as event_230,
	coalesce(i_p.event_231,
	i_p_wo.event_231) as event_231,
	coalesce(i_p.event_232,
	i_p_wo.event_232) as event_232,
	coalesce(i_p.event_233,
	i_p_wo.event_233) as event_233,
	coalesce(i_p.event_234,
	i_p_wo.event_234) as event_234,
	coalesce(i_p.event_235,
	i_p_wo.event_235) as event_235,
	coalesce(i_p.event_236,
	i_p_wo.event_236) as event_236,
	coalesce(i_p.event_237,
	i_p_wo.event_237) as event_237,
	coalesce(i_p.event_238,
	i_p_wo.event_238) as event_238,
	coalesce(i_p.event_239,
	i_p_wo.event_239) as event_239,
	coalesce(i_p.event_240,
	i_p_wo.event_240) as event_240,
	coalesce(i_p.event_241,
	i_p_wo.event_241) as event_241,
	coalesce(i_p.event_242,
	i_p_wo.event_242) as event_242,
	coalesce(i_p.event_243,
	i_p_wo.event_243) as event_243,
	coalesce(i_p.event_244,
	i_p_wo.event_244) as event_244,
	coalesce(i_p.event_245,
	i_p_wo.event_245) as event_245,
	coalesce(i_p.event_246,
	i_p_wo.event_246) as event_246,
	coalesce(i_p.event_247,
	i_p_wo.event_247) as event_247,
	coalesce(i_p.event_248,
	i_p_wo.event_248) as event_248,
	coalesce(i_p.event_249,
	i_p_wo.event_249) as event_249,
	coalesce(i_p.event_250,
	i_p_wo.event_250) as event_250,
	coalesce(i_p.event_251,
	i_p_wo.event_251) as event_251,
	coalesce(i_p.event_252,
	i_p_wo.event_252) as event_252,
	coalesce(i_p.event_253,
	i_p_wo.event_253) as event_253,
	coalesce(i_p.event_254,
	i_p_wo.event_254) as event_254,
	coalesce(i_p.event_255,
	i_p_wo.event_255) as event_255,
	coalesce(i_p.event_256,
	i_p_wo.event_256) as event_256,
	coalesce(i_p.event_257,
	i_p_wo.event_257) as event_257,
	coalesce(i_p.event_258,
	i_p_wo.event_258) as event_258,
	coalesce(i_p.event_259,
	i_p_wo.event_259) as event_259,
	coalesce(i_p.event_260,
	i_p_wo.event_260) as event_260,
	coalesce(i_p.event_261,
	i_p_wo.event_261) as event_261,
	coalesce(i_p.event_262,
	i_p_wo.event_262) as event_262,
	coalesce(i_p.event_263,
	i_p_wo.event_263) as event_263,
	coalesce(i_p.event_264,
	i_p_wo.event_264) as event_264,
	coalesce(i_p.event_265,
	i_p_wo.event_265) as event_265,
	coalesce(i_p.event_266,
	i_p_wo.event_266) as event_266,
	coalesce(i_p.event_267,
	i_p_wo.event_267) as event_267,
	coalesce(i_p.event_268,
	i_p_wo.event_268) as event_268,
	coalesce(i_p.event_269,
	i_p_wo.event_269) as event_269,
	coalesce(i_p.event_270,
	i_p_wo.event_270) as event_270,
	coalesce(i_p.event_271,
	i_p_wo.event_271) as event_271,
	coalesce(i_p.event_272,
	i_p_wo.event_272) as event_272,
	coalesce(i_p.event_273,
	i_p_wo.event_273) as event_273,
	coalesce(i_p.event_274,
	i_p_wo.event_274) as event_274,
	coalesce(i_p.event_275,
	i_p_wo.event_275) as event_275,
	coalesce(i_p.event_276,
	i_p_wo.event_276) as event_276,
	coalesce(i_p.event_277,
	i_p_wo.event_277) as event_277,
	coalesce(i_p.event_278,
	i_p_wo.event_278) as event_278,
	coalesce(i_p.event_279,
	i_p_wo.event_279) as event_279,
	coalesce(i_p.event_280,
	i_p_wo.event_280) as event_280,
	coalesce(i_p.event_281,
	i_p_wo.event_281) as event_281,
	coalesce(i_p.event_282,
	i_p_wo.event_282) as event_282,
	coalesce(i_p.event_283,
	i_p_wo.event_283) as event_283,
	coalesce(i_p.event_284,
	i_p_wo.event_284) as event_284,
	coalesce(i_p.event_285,
	i_p_wo.event_285) as event_285,
	coalesce(i_p.event_286,
	i_p_wo.event_286) as event_286,
	coalesce(i_p.event_287,
	i_p_wo.event_287) as event_287,
	coalesce(i_p.event_288,
	i_p_wo.event_288) as event_288,
	coalesce(i_p.event_289,
	i_p_wo.event_289) as event_289,
	coalesce(i_p.event_290,
	i_p_wo.event_290) as event_290,
	coalesce(i_p.event_291,
	i_p_wo.event_291) as event_291,
	coalesce(i_p.event_292,
	i_p_wo.event_292) as event_292,
	coalesce(i_p.event_293,
	i_p_wo.event_293) as event_293,
	coalesce(i_p.event_294,
	i_p_wo.event_294) as event_294,
	coalesce(i_p.event_295,
	i_p_wo.event_295) as event_295,
	coalesce(i_p.event_296,
	i_p_wo.event_296) as event_296,
	coalesce(i_p.event_297,
	i_p_wo.event_297) as event_297,
	coalesce(i_p.event_298,
	i_p_wo.event_298) as event_298,
	coalesce(i_p.event_299,
	i_p_wo.event_299) as event_299,
	coalesce(i_p.event_300,
	i_p_wo.event_300) as event_300,
	coalesce(i_p.event_301,
	i_p_wo.event_301) as event_301
from
	object_with_work as o_w
left join incident_pivot_sum_final_gr_bydate as i_p on
	o_w.unom = i_p.unom
	and i_p.fact_date_start = o_w.fact_date_start
	and i_p.work_type_id = o_w.work_type_id
left join incident_pivot_sum_final_gr_byunom as i_p_wo on
	o_w.unom = i_p_wo.unom
	and i_p.fact_date_start is null;
commit;